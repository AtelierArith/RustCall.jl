<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Precompilation · RustCall.jl</title><meta name="title" content="Precompilation · RustCall.jl"/><meta property="og:title" content="Precompilation · RustCall.jl"/><meta property="twitter:title" content="Precompilation · RustCall.jl"/><meta name="description" content="Documentation for RustCall.jl."/><meta property="og:description" content="Documentation for RustCall.jl."/><meta property="twitter:description" content="Documentation for RustCall.jl."/><meta property="og:url" content="https://atelierarith.github.io/RustCall.jl/precompilation/"/><meta property="twitter:url" content="https://atelierarith.github.io/RustCall.jl/precompilation/"/><link rel="canonical" href="https://atelierarith.github.io/RustCall.jl/precompilation/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">RustCall.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../examples/">Examples</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../struct_mapping/">Struct Mapping</a></li><li><a class="tocitem" href="../generics/">Generics</a></li><li><a class="tocitem" href="../crate_bindings/">External Crate Bindings</a></li><li class="is-active"><a class="tocitem" href>Precompilation</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#How-It-Works"><span>How It Works</span></a></li><li><a class="tocitem" href="#Usage-Guide"><span>Usage Guide</span></a></li><li><a class="tocitem" href="#PackageCompiler.jl-Integration"><span>PackageCompiler.jl Integration</span></a></li><li><a class="tocitem" href="#Cache-Behavior"><span>Cache Behavior</span></a></li><li><a class="tocitem" href="#Troubleshooting"><span>Troubleshooting</span></a></li><li><a class="tocitem" href="#Best-Practices"><span>Best Practices</span></a></li><li><a class="tocitem" href="#Example:-Complete-Package"><span>Example: Complete Package</span></a></li><li><a class="tocitem" href="#See-Also"><span>See Also</span></a></li></ul></li><li><a class="tocitem" href="../troubleshooting/">Troubleshooting</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../api/">API Reference</a></li><li><a class="tocitem" href="../status/">Project Status</a></li></ul></li><li><span class="tocitem">Design</span><ul><li><a class="tocitem" href="../design/Phase1/">Phase 1</a></li><li><a class="tocitem" href="../design/Phase2/">Phase 2</a></li><li><a class="tocitem" href="../design/INTERNAL/">Internal</a></li><li><a class="tocitem" href="../design/LLVMCALL/">LLVM Call</a></li></ul></li><li><span class="tocitem">Platforms</span><ul><li><a class="tocitem" href="../platforms/windows/">Windows</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Precompilation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Precompilation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AtelierArith/RustCall.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AtelierArith/RustCall.jl/blob/ddc1c5a34a02fe46a55435a31801269fb2876867/docs/src/precompilation.md" title="View source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Precompilation-Support"><a class="docs-heading-anchor" href="#Precompilation-Support">Precompilation Support</a><a id="Precompilation-Support-1"></a><a class="docs-heading-anchor-permalink" href="#Precompilation-Support" title="Permalink"></a></h1><p>RustCall.jl supports Julia&#39;s precompilation system, enabling faster startup times for packages that use Rust bindings.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>When you use <code>@rust_crate</code> in a Julia package, the bindings can be precompiled along with your package. This avoids runtime compilation and significantly reduces startup time.</p><h3 id="Benefits"><a class="docs-heading-anchor" href="#Benefits">Benefits</a><a id="Benefits-1"></a><a class="docs-heading-anchor-permalink" href="#Benefits" title="Permalink"></a></h3><ul><li><strong>Faster startup</strong>: Precompiled bindings load instantly</li><li><strong>Deployment-ready</strong>: No compilation needed at runtime</li><li><strong>Reproducible builds</strong>: Same bindings every time</li><li><strong>PackageCompiler.jl compatible</strong>: Works with standalone applications</li></ul><h2 id="How-It-Works"><a class="docs-heading-anchor" href="#How-It-Works">How It Works</a><a id="How-It-Works-1"></a><a class="docs-heading-anchor-permalink" href="#How-It-Works" title="Permalink"></a></h2><h3 id="Runtime-vs-Precompile-Time"><a class="docs-heading-anchor" href="#Runtime-vs-Precompile-Time">Runtime vs Precompile Time</a><a id="Runtime-vs-Precompile-Time-1"></a><a class="docs-heading-anchor-permalink" href="#Runtime-vs-Precompile-Time" title="Permalink"></a></h3><p><strong>Without precompilation</strong> (using <code>@rust_crate</code> directly):</p><ol><li>Julia loads your package</li><li><code>@rust_crate</code> scans the Rust crate</li><li>Rust code is compiled (if not cached)</li><li>Bindings are generated and evaluated</li></ol><p><strong>With precompilation</strong> (using <code>write_bindings_to_file</code>):</p><ol><li>During development: Generate bindings file once</li><li>During precompilation: Julia compiles the bindings module</li><li>At runtime: Precompiled bindings load instantly</li></ol><h3 id="The-Generation-Process"><a class="docs-heading-anchor" href="#The-Generation-Process">The Generation Process</a><a id="The-Generation-Process-1"></a><a class="docs-heading-anchor-permalink" href="#The-Generation-Process" title="Permalink"></a></h3><pre><code class="nohighlight hljs">Rust Crate               Julia Bindings File
    │                           │
    ├── Cargo.toml              │
    ├── src/                    │
    │   └── lib.rs ──────────►  MyBindings.jl
    │                           │
    └── target/                 │
        └── release/            │
            └── lib*.so ◄───────┘</code></pre><h2 id="Usage-Guide"><a class="docs-heading-anchor" href="#Usage-Guide">Usage Guide</a><a id="Usage-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Guide" title="Permalink"></a></h2><h3 id="Step-1:-Project-Structure"><a class="docs-heading-anchor" href="#Step-1:-Project-Structure">Step 1: Project Structure</a><a id="Step-1:-Project-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Project-Structure" title="Permalink"></a></h3><p>Set up your package with this structure:</p><pre><code class="nohighlight hljs">MyPackage/
├── Project.toml
├── src/
│   ├── MyPackage.jl          # Main module
│   └── generated/
│       └── RustBindings.jl   # Generated bindings (gitignore this)
├── deps/
│   ├── my_rust_crate/        # Your Rust crate
│   │   ├── Cargo.toml
│   │   └── src/lib.rs
│   └── lib/                  # Compiled library location
│       └── libmy_rust_crate.{so,dylib,dll}
└── build.jl                  # Build script</code></pre><h3 id="Step-2:-Build-Script"><a class="docs-heading-anchor" href="#Step-2:-Build-Script">Step 2: Build Script</a><a id="Step-2:-Build-Script-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Build-Script" title="Permalink"></a></h3><p>Create a <code>build.jl</code> to generate bindings:</p><pre><code class="language-julia hljs"># deps/build.jl
using RustCall

# Path to Rust crate
crate_path = joinpath(@__DIR__, &quot;my_rust_crate&quot;)

# Output path for generated bindings
bindings_path = joinpath(dirname(@__DIR__), &quot;src&quot;, &quot;generated&quot;, &quot;RustBindings.jl&quot;)

# Generate bindings
write_bindings_to_file(
    crate_path,
    bindings_path,
    output_module_name = &quot;RustBindings&quot;,
    build_release = true,
    relative_lib_path = &quot;../../deps/lib&quot;
)</code></pre><h3 id="Step-3:-Package-Module"><a class="docs-heading-anchor" href="#Step-3:-Package-Module">Step 3: Package Module</a><a id="Step-3:-Package-Module-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Package-Module" title="Permalink"></a></h3><p>Include the generated bindings in your package:</p><pre><code class="language-julia hljs"># src/MyPackage.jl
module MyPackage

# Include generated bindings
include(&quot;generated/RustBindings.jl&quot;)
using .RustBindings

# Re-export functions
export add, multiply, MyStruct

# Your Julia code here...

end</code></pre><h3 id="Step-4:-Build-During-Development"><a class="docs-heading-anchor" href="#Step-4:-Build-During-Development">Step 4: Build During Development</a><a id="Step-4:-Build-During-Development-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4:-Build-During-Development" title="Permalink"></a></h3><p>Run the build script during development:</p><pre><code class="language-julia hljs">using Pkg
Pkg.build(&quot;MyPackage&quot;)</code></pre><p>Or manually:</p><pre><code class="language-julia hljs">include(&quot;deps/build.jl&quot;)</code></pre><h2 id="PackageCompiler.jl-Integration"><a class="docs-heading-anchor" href="#PackageCompiler.jl-Integration">PackageCompiler.jl Integration</a><a id="PackageCompiler.jl-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#PackageCompiler.jl-Integration" title="Permalink"></a></h2><p>RustCall.jl works with PackageCompiler.jl for creating standalone applications.</p><h3 id="Creating-a-System-Image"><a class="docs-heading-anchor" href="#Creating-a-System-Image">Creating a System Image</a><a id="Creating-a-System-Image-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-System-Image" title="Permalink"></a></h3><pre><code class="language-julia hljs">using PackageCompiler

create_sysimage(
    :MyPackage,
    sysimage_path = &quot;my_sysimage.so&quot;,
    precompile_execution_file = &quot;precompile_script.jl&quot;
)</code></pre><h3 id="Creating-an-App"><a class="docs-heading-anchor" href="#Creating-an-App">Creating an App</a><a id="Creating-an-App-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-an-App" title="Permalink"></a></h3><pre><code class="language-julia hljs">using PackageCompiler

create_app(
    &quot;.&quot;,                    # Package directory
    &quot;build&quot;,               # Output directory
    executables = [&quot;main&quot; =&gt; &quot;main.jl&quot;]
)</code></pre><h3 id="Important-Considerations"><a class="docs-heading-anchor" href="#Important-Considerations">Important Considerations</a><a id="Important-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Important-Considerations" title="Permalink"></a></h3><ol><li><strong>Library Path</strong>: Use <code>relative_lib_path</code> to ensure the compiled library is found relative to the bindings file</li><li><strong>Copy Library</strong>: Ensure the compiled <code>.so</code>/<code>.dylib</code>/<code>.dll</code> is included in the app bundle</li><li><strong>Precompile Script</strong>: Include calls to your Rust-backed functions in the precompile script</li></ol><p>Example precompile script:</p><pre><code class="language-julia hljs"># precompile_script.jl
using MyPackage

# Warm up the functions
MyPackage.add(Int32(1), Int32(2))
MyPackage.multiply(1.0, 2.0)</code></pre><h2 id="Cache-Behavior"><a class="docs-heading-anchor" href="#Cache-Behavior">Cache Behavior</a><a id="Cache-Behavior-1"></a><a class="docs-heading-anchor-permalink" href="#Cache-Behavior" title="Permalink"></a></h2><h3 id="During-Development"><a class="docs-heading-anchor" href="#During-Development">During Development</a><a id="During-Development-1"></a><a class="docs-heading-anchor-permalink" href="#During-Development" title="Permalink"></a></h3><ul><li>FirstCall.jl caches compiled libraries in <code>~/.julia/rustcall_cache/</code></li><li>Cache is keyed by source code hash</li><li>Rebuilding only happens when source changes</li></ul><h3 id="During-Precompilation"><a class="docs-heading-anchor" href="#During-Precompilation">During Precompilation</a><a id="During-Precompilation-1"></a><a class="docs-heading-anchor-permalink" href="#During-Precompilation" title="Permalink"></a></h3><ul><li>Generated bindings reference a fixed library path</li><li>Library must exist at the specified path</li><li>No runtime compilation occurs</li></ul><h3 id="Cache-Functions"><a class="docs-heading-anchor" href="#Cache-Functions">Cache Functions</a><a id="Cache-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Cache-Functions" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Clear the cache
clear_cache()

# Check cache size
get_cache_size()

# List cached libraries
list_cached_libraries()

# Clean up old cache entries
cleanup_old_cache(max_age_days=30)</code></pre><h2 id="Troubleshooting"><a class="docs-heading-anchor" href="#Troubleshooting">Troubleshooting</a><a id="Troubleshooting-1"></a><a class="docs-heading-anchor-permalink" href="#Troubleshooting" title="Permalink"></a></h2><h3 id="Library-Not-Found"><a class="docs-heading-anchor" href="#Library-Not-Found">Library Not Found</a><a id="Library-Not-Found-1"></a><a class="docs-heading-anchor-permalink" href="#Library-Not-Found" title="Permalink"></a></h3><p><strong>Error</strong>: <code>could not load library &quot;...&quot;</code> at runtime</p><p><strong>Solutions</strong>:</p><ol><li>Verify <code>relative_lib_path</code> points to the correct location</li><li>Check that the library was copied during build</li><li>Ensure the library has correct permissions</li></ol><pre><code class="language-julia hljs"># Debug: Check the library path
bindings_dir = dirname(pathof(MyPackage))
lib_path = joinpath(bindings_dir, &quot;..&quot;, &quot;deps&quot;, &quot;lib&quot;, &quot;libmy_crate.so&quot;)
@info &quot;Library exists?&quot; isfile(lib_path)</code></pre><h3 id="Precompilation-Fails"><a class="docs-heading-anchor" href="#Precompilation-Fails">Precompilation Fails</a><a id="Precompilation-Fails-1"></a><a class="docs-heading-anchor-permalink" href="#Precompilation-Fails" title="Permalink"></a></h3><p><strong>Error</strong>: <code>LoadError</code> during precompilation</p><p><strong>Solutions</strong>:</p><ol><li>Ensure <code>__init__()</code> function loads the library correctly</li><li>Check that library path uses <code>@__DIR__</code> for portability</li><li>Verify the generated code syntax</li></ol><h3 id="Version-Mismatch"><a class="docs-heading-anchor" href="#Version-Mismatch">Version Mismatch</a><a id="Version-Mismatch-1"></a><a class="docs-heading-anchor-permalink" href="#Version-Mismatch" title="Permalink"></a></h3><p><strong>Symptom</strong>: Functions behave unexpectedly after updating Rust code</p><p><strong>Solution</strong>: Regenerate bindings after modifying Rust code:</p><pre><code class="language-julia hljs">Pkg.build(&quot;MyPackage&quot;)</code></pre><h3 id="Platform-Specific-Issues"><a class="docs-heading-anchor" href="#Platform-Specific-Issues">Platform-Specific Issues</a><a id="Platform-Specific-Issues-1"></a><a class="docs-heading-anchor-permalink" href="#Platform-Specific-Issues" title="Permalink"></a></h3><p><strong>macOS</strong>:</p><ul><li>Library extension is <code>.dylib</code></li><li>May need to handle code signing</li></ul><p><strong>Linux</strong>:</p><ul><li>Library extension is <code>.so</code></li><li>Check <code>LD_LIBRARY_PATH</code> if needed</li></ul><p><strong>Windows</strong>:</p><ul><li>Library extension is <code>.dll</code></li><li>Place DLLs in the same directory as the Julia process or in PATH</li></ul><h2 id="Best-Practices"><a class="docs-heading-anchor" href="#Best-Practices">Best Practices</a><a id="Best-Practices-1"></a><a class="docs-heading-anchor-permalink" href="#Best-Practices" title="Permalink"></a></h2><ol><li><strong>Gitignore generated files</strong>: Add <code>src/generated/</code> to <code>.gitignore</code></li><li><strong>Version your Rust code</strong>: Keep Rust crate under version control</li><li><strong>CI/CD integration</strong>: Run <code>Pkg.build()</code> in CI to generate fresh bindings</li><li><strong>Test precompilation</strong>: Include precompilation in your test suite</li><li><strong>Document dependencies</strong>: Note Rust toolchain requirements in README</li></ol><h2 id="Example:-Complete-Package"><a class="docs-heading-anchor" href="#Example:-Complete-Package">Example: Complete Package</a><a id="Example:-Complete-Package-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Complete-Package" title="Permalink"></a></h2><p>Here&#39;s a complete example of a precompilable package:</p><pre><code class="language-julia hljs"># Project.toml
name = &quot;MyRustPackage&quot;
uuid = &quot;...&quot;
version = &quot;0.1.0&quot;

[deps]
RustCall = &quot;...&quot;

[extras]
Test = &quot;...&quot;

[targets]
test = [&quot;Test&quot;]</code></pre><pre><code class="language-julia hljs"># deps/build.jl
using RustCall

write_bindings_to_file(
    joinpath(@__DIR__, &quot;rust_crate&quot;),
    joinpath(dirname(@__DIR__), &quot;src&quot;, &quot;generated&quot;, &quot;Bindings.jl&quot;),
    output_module_name = &quot;Bindings&quot;,
    relative_lib_path = &quot;../../deps/lib&quot;
)</code></pre><pre><code class="language-julia hljs"># src/MyRustPackage.jl
module MyRustPackage

include(&quot;generated/Bindings.jl&quot;)
using .Bindings

export rust_add, rust_multiply

rust_add(a, b) = Bindings.add(Int32(a), Int32(b))
rust_multiply(a, b) = Bindings.multiply(Float64(a), Float64(b))

end</code></pre><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><a href="../crate_bindings/">External Crate Bindings</a> - Full API reference</li><li><a href="https://docs.julialang.org/en/v1/manual/modules/#Module-initialization-and-precompilation">Julia Precompilation</a> - Official Julia documentation</li><li><a href="https://github.com/JuliaLang/PackageCompiler.jl">PackageCompiler.jl</a> - Creating standalone applications</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../crate_bindings/">« External Crate Bindings</a><a class="docs-footer-nextpage" href="../troubleshooting/">Troubleshooting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 9 February 2026 09:01">Monday 9 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
